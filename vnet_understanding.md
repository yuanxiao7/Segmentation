## vet网络理解

### vet 网络模块

```python
LUConv模块
先进行3D的卷积nn.Conv3D再正则化BatchNorm3D后经过激活函数nn.ELU() else PReLU
```

```python
_make_nConv 模块
由depth个LUConv模块组成的深层网络层 装在列表中，即返回的是列表
```

```python
InputTransition 模块
将输入转为16个通道+平铺输入

先进行一个3D卷积nn.Conv3D，获取重复值比例，进行正则化BatchNorm3D，然后，x根据重复值比例重复值，返回进过一次3D卷积nn.Conv3D的out和经过激活函数的x
```

```
DownTransition 模块
1.将输出通道加倍，并使用down_conv对输入进行采样(内核大小可以更改)
2.添加按选项退出
3.添加nConvs层来增加线性度，并添加原始下采样1

先进行通道改变的3D卷积得到down
根据需求获取随机drop down的结果out
然后结果out经过_make_nConv 模块 深层网络层得到out
然后进行out 和 down的融合，有点稀疏残差机制和注意力结合的意思
再经过激活函数
返回out

```

```
UpTransition 模块
1. 在输入中添加dropout并可选地跳过输入(泛化)
2. 使用Conv3DTranspose进行上采样(upsample)
3.连接上采样和跳过(多层特征融合)
4. 添加nConvs (convs)和残差(残差+非线性)

根据条件进行drop得到out
根据条件进行drop得到skipx
上采样  conv + bn + activate
然后上采样out和可选跳过输出skipx融合得xcat
xcat再经过深层卷积层out得out
然后out和xcat融合经激活函数得到输出out

```

```
OutputTransition(nn.Layer) 模块
将输出转换为所需类的通道

经过3D卷积将输出通道数改成类别数
在经过3D卷积得到out
```



### vnet backbone

```
V-Net

x先是经过 InputTransition 模块 进行通道转换 C=16 
先经过 4个 DownTransition 模块 下采样
在经过 4个 UpTransition   模块 上采样
最后经过维度转换，输出结果out
```



错误尝试：

768 768 100   报了错下面这个错误，可见，网络的参数赋值错误，传参错误也会引起cuda、cudnn的报错

```
CUDNN_STATUS_BAD_PARAM
传递给函数的值或参数不正确。

若要更正，请确保传递的所有参数都具有有效值。
```



```
输入的通道数量应该等于Op(Conv)的filter的通道*组。但接收到:输入的通道为320，输入的形状为[2,320,5,10,10];所述滤波器的通道为1，所述滤波器的形状为[16,1,5,5,5];组为1,data＿format为NCDHW。错误可能来自错误的data＿format设置。
[提示:期望的input＿channels == filter＿dims[1] * groups，但是收到的input＿channels:320 != filter＿dims[1] * groups:1。](在……\paddle\phi\infermeta\binary .cc:529)
```



正确测试

```python
    # 以下是用于了解vnet网络的测试
    m = VNet(in_channels=16, num_classes=3)
    x = paddle.randn([1, 16, 32, 32, 32])
    print(x.shape)
    out = m.forward(x)
    print(out)   
    # out ：
    Tensor(shape=[1, 3, 32, 32, 32], dtype=float32, place=Place(gpu:0), stop_gradient=False,
    [ [ 0.34414890,  0.31823096,  0.84229159, ...,  0.33816215,
             1.13530278,  1.47949076],]
    
    print(out[0].shape)  # [1, 3, 32, 32, 32]
```

尽管有很多warning，但是，不要理他，他不影响，目的导向，做好自己要完成的功能的先

至此，v-net网络了解完毕，有想法可以进行一定的改进，因为目前官方的精度真的很低，有很大提升空间。

### 2D和3D

## 2D 和 3D 对比表



| **比较参数** | **2D**                                   | **3D**                             |
| ------------ | ---------------------------------------- | ---------------------------------- |
| **定义**     | 二维形状有两个维度，可以在任何地方绘制。 | 3D形状有三种尺寸，它们在现实中存在 |
| **使用的轴** | 二维形状覆盖图形上的 x 轴和 y 轴。       | 3D 形状覆盖图形上的 x、y 和 z 轴。 |
| **尺寸**     | 它有长度和宽度。                         | 它有长度、宽度和高度。             |
| **其他名称** | 平面形状，平面形状由于它们的特性。       | 这些被称为 3D 图形。               |
| **项目范例** | 正方形、长方形、三角形等。               | 立方体、长方体、棱柱体等           |



## 什么是 2D？

2D是二维的缩写。 平面二维对象仅包含两个参数：长度和宽度。 矩形、三角形、正方形、菱形和其他形状。

平面结构，通常称为封闭二维或扁平平面形式，是二维形状的另一个术语。

我们在日常生活中遇到的大多数物体都可以归类为基本形式。 不同尺寸形状之间的边或顶点数量不同。 边是构成形状一部分的直线，角或顶点是两条边的连接点。



## 什么是 3D？ 

3D 或三维形状参数包括长度、高度和宽度（深度）。 3 维图形在图形的 x、y 和 z 轴上进行数学表示。 许多最常见的三维结构是半球、金字塔和长方体。

这些用于各种目的，包括 3D 图形、3D 设计流程、桥梁、工具、3D 图形、图表等。 3D 形状有助于显示对象的深度。 我们采用 2 点和 3 点透视投影以及正交投影来展示 3D 建筑。

3d 结构中使用的形式有球体、立方体、圆锥体、长方体、棱柱体等。 



每当两条相交线之间的间隙比例明显超过 3D 形状所能达到的程度时，就会创建 2D 结构。 立方体和圆柱体是两种常见的 3D 形状。

可以从单个图像的所有角落观察到的表面称为 3D 形式。 它们有一个甚至更多的边缘，使它们比 3D 更重要，因为它们的表面少于三个，并且必须识别一个焦点以在三维空间中存在。 

## 2D 和 3D 之间的主要区别

1. 但是，通常很明显植物是二维的而不是三维的； 这并不总是现实。 例如，飞机是具有 3D 形状的 2D 物体。
2. 在我们的日常生活中，2D 和 3D 形式之间存在许多值得注意的对比。 2D 和 3D 事物具有不同的品质，这取决于它们在纸上的表现方式以及它们在现实中的表现方式。
3. 与穿过 2D 物体的光束相比，流过 3D 物体的光被分解成更多数量的微小波或粒子。 通过这两种物体的光量会影响它们在使用各种照明方法的图片或绘画中的外观。
4. 2d 和 3d 结构之间的另一个区别是前者只有一个维度，例如宽度或高度，而后者具有三个维度，包括长度、宽度和高度。
5. 2D 形状表现出主要效果，例如正方形、五边形、六边形等基本形状，这有助于在绘制任何 2D 图案时在程序中创建复杂的形状。 相反，我们应该在 3D 中以五边形使用这些矩形，但我们不能将它们全部堆叠在一起。
6. 当我们绘制二维结构图时，我们无法显示在绘图纸上绘制的任何项目的阴影。 正如该展览中其他度数或第三轴所反映的那样，特别是 Z。 要显示阴影，我们必须始终以 2D 方式描绘它。

## 

2D 和 3D 卷积的理解

2d卷积只是在h和w上移动，c上不移动，然后求和，一个卷积核计算出来就是一个平面。而3d卷积，c，h，w上都可以移动，求和后c上也有维度了，所以一个卷积核求出来是一个立方体，多个卷积核求出来就是4D张量了。不管是2d卷积还是3d卷积，他们的卷积核都是立方体，只不过2d卷积的卷积核在c和输入一致，不能移动。并且2d和3d卷积在c上的参数都是不一样的







